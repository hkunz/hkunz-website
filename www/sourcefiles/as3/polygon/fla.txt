import Polygon.as; //Import Harry's Polygon Class
var nRotation:Number = 0;
var nSides:Number = 5;
var mcPoly:MovieClip = this.createEmptyMovieClip("Triangle_MC", 3);
var cPoly:Polygon = new Polygon(Stage.width/2, Stage.height/2, 100, nSides, mcPoly, this.getNextHighestDepth(), 3, 0x000000, 100, 0x0066FF, 80);
var oListener:Object = new Object();
cPoly.setStrokeAlpha(20);
mcPoly.onPress = function() {mcPoly.startDrag();}
mcPoly.onRelease = function() {mcPoly.stopDrag(); mcPoly._x = 0;  mcPoly._y = 0;}
mcPoly.onReleaseOutside = function() {mcPoly.stopDrag(); mcPoly._x = 0;  mcPoly._y = 0;}

cStepper.value = nSides;

oListener.change = function(oEvent:Object) {cPoly.setSides(cStepper.value);}
cStepper.addEventListener("change", oListener);

mcPoly.onEnterFrame = function()
{
   cPoly.setRotation(nRotation);
   nRotation += 1;
   nRotation %=360;
}